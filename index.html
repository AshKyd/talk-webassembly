<html>
  <head>
        <meta charset="utf-8">
        <script defer src="vendor/reveal.js"></script>
        <script defer src="play-it-in-revealjs.js"></script>
        <link rel="stylesheet" href="vendor/reveal.css">
        <link rel="stylesheet" href="vendor/black.css">

        <style type="text/css">
          body{background: #262530;}
          .reveal blockquote{padding: 1em;border-radius: 1em;}
          .reveal section img.emojione{margin:0;padding:0;background:transparent;box-shadow:none;border:none;}
          .reveal section img.plain{background:transparent;}
          .reveal section img.plain.glow{box-shadow:0 0 200px white;background:rgba(255,255,255,.5);}
          .row{display:flex;}
          .row > *{width:50%;}
          .row.left > *,
          .left{text-align: left;}
          .reveal table{color:#fff;}
          .reveal table pre{width:auto;margin:0;box-shadow: none;}
          .reveal table tr{border:none;}
          .reveal table td{color:rgba(255,255,255,.9);border-bottom:3px solid rgba(255,255,255,0.2);}
          .reveal table tr.fragment td{border-bottom-color: rgba(255,255,255,.0);transition:all 0.2s ease;}
          .reveal table tr.fragment.visible td{border-bottom-color: rgba(255,255,255,.2);}
          .reveal table tr.fragment.current-fragment td{;color:white;}
          .reveal table th{border-bottom:3px solid white;}
          .reveal ul.no-bullets{list-style:none;}
          .reveal section img.overlay{position:absolute;left:0;width:100%;max-width:none;max-height:none;height:auto;visibility:visible;opacity:1;}
          .reveal section img.overlay.fragment{}

          .reveal section img.a1-wasm, .reveal section img.a1-js{position:absolute;width:300px;top:50%;left:50%;margin-left:-150px;max-width:none;max-height:none;}
          .reveal section img.a1-wasm{height:300px;margin-top:300px;}
          .reveal section img.a1-js{height:336px;margin-top:0px}
          .reveal section img.a1-js.visible{animation: 0.5s slide-down cubic-bezier(0.175, 0.885, 0.32, 1.275);}
          .a1-attribution{position:absolute;top:calc(50% + 610px);width:100%;text-align:center;}
          .reveal .headingthing{border-bottom:3px solid white;margin-top:30px;margin-bottom:10px; opacity:0.6;}

          /* Hacky cursor blink in play it again sam thing. */
          span[style="background:#00ff00;color:#ffffff;"]{
            animation: 0.8s cursor-blink infinite;
          }

          .terminal{position:static !important;}
          .emulator{
            text-align: left;
            font-family: monospace !important;
            position: absolute !important;
            left: 0;
            top: 0;
            right: 0;
            bottom: 0;
          }

          @keyframes cursor-blink{
            from{
              opacity: 1;
            }
            50%{
              opacity:0.2;
            }
            to{
              opacity:1;
            }
          }

          @keyframes slide-down{
            from{
              opacity:0;
              transform: translate(0, -200px);
            }
            to{
              opacity:1;
              transform: translate(0, 0);
            }
          }
        </style>

        <script defer>
          navigator.serviceWorker.register('service-worker.js', {
            scope: '/'
          });
          document.addEventListener('DOMContentLoaded', () => {
            Array.from(document.querySelectorAll('pre.reformat'))
              .forEach(ele => ele.innerHTML = ele.innerHTML.replace(/\n +/g, '\n'));
            Reveal.initialize({
              history: true,
              width:1280,
              height:720,
            });
          });
        </script>
    </head>
    <body>
        <div class="reveal">
          <div class="slides">
            <section id="intro">
              <h1><img src="images/webassembly-logo.svg" alt="WebAssembly" class="plain"></h1>
              <p style="font-size:0.6em;">@ashkyd | ash.ms</p>
              <p><small><script>document.write(window.location)</script></small></p>
            </section>
            <section id="intro-extended">
              <section id="remember-when">
                <h2>Remember when people used to write Javascript?</h2>
              </section>
              <section id="octoverse" data-background="images/popular-langs.png"></section>
              <section id="tools-we-use">
                <h2>More sophisticated tools</h2>
                <!-- TODO: graphics? -->
                <ul>
                  <li class="fragment">CoffeeScript</li>
                  <li class="fragment">Babel (ESNext)</li>
                  <li class="fragment">TypeScript</li>
                  <li class="fragment">C/C++</li>
                  <li class="fragment">pretty much anything</li>
                </ul>
              </section>
              <section id="compile-to-language">
                <h2>JS has become a compile target</h2>
              </section>
              <section id="precompiled-workflow">
                <h2>General precompiled workflow</h2>
                <ol>
                  <li>write code</li>
                  <li class="fragment">compile to JS</li>
                  <li class="fragment">run JS in browser</li>
                </ol>
              </section>
              <section id="running-in-browser">
                <h2>Run in the browser</h2>
                <table>
                <tbody>
                <tr class="fragment"><td>download script</td></tr>
                <tr class="fragment"><td>unzip</td></tr>
                <tr class="fragment"><td>parse JS</td></tr>
                <tr class="fragment"><td>optimize</td></tr>
                <tr class="fragment"><td>compile to machine code</td></tr>
                <tr class="fragment"><td>run on CPU</td></tr>
                </tbody>
                </table>
              </section>
              <section id="javascript-benchmark-stats" data-background="#000">
                <h2><small>Parse times for a 1MB bundle of JS</small></h2>
                <img class="stretch plain" src="images/render-times-chart.png" alt="compile time in JS ramps up rapidly for older, and especially mobile devices">
                <p><small>Addy Osmani: <a href="https://medium.com/reloading/javascript-start-up-performance-69200f43b201">JavaScript Start-up Performance</a></small></p>
                <!-- Kicker: what if we could skip the compile step and go straight to the bare metal? :O -->
              </section>
              <section id="wasm-description">
                <blockquote cite="http://webassembly.org/">WebAssembly (or wasm) is a new portable, size- and
                  load-time-efficient format suitable for compilation to the web.</blockquote>
                  <a href="http://webassembly.org/">webassembly.org</a>
              </section>
              <section id="wasm-precompiled-workflow">
                <h2>WebAssembly precompiled workflow</h2>
                <ol>
                  <li>write code <span class="fragment">(C, C++, Rust)</span></li>
                  <li class="fragment">compile to wasm</li>
                  <li class="fragment">run wasm in browser</li>
                </ol>
              </section>
              <section id="wasm-running-in-browser">
                <h2>Run in the browser</h2>
                <table>
                  <thead>
                    <tr><th>Javascript</th><th>Wasm</th></tr>
                  </thead>
                  <tbody>
                    <tr class="fragment"><td>download script</td><td>download binary</td></tr>
                    <tr class="fragment"><td>unzip</td><td><strong>¯\_(ツ)_/¯</strong></td></tr>
                    <tr class="fragment"><td>parse JS</td><td>-</td></tr>
                    <tr class="fragment"><td>optimize</td><td>-</td></tr>
                    <tr class="fragment"><td>compile to machine code</td><td>compile to machine code</td></tr>
                    <tr class="fragment"><td>run on CPU</td><td>run on CPU</td></tr>
                  </tbody>
                </table>
              </section>
              <section id="wasm-keypoints">
                <h2>Key points</h2>
                <ul>
                  <li>wasm is <em>not</em> a language</li>
                  <li class="fragment">a compile target</li>
                  <li class="fragment">binary format/bytecode</li>
                  <li class="fragment">runs in the wasm stack machine</li><!-- alongside JS -->
                </ul>
              </section>
              <section id="fast">
                <h2 style="position: absolute;top: 330px;width: 100%;">Oh, and it's fast</h2>
                <img src="images/overlay-sometimes-fast.svg" alt="sometimes" class="fragment plain overlay">
              </section>
            </section>
            <section id="the-spec">
              <section id="format-comparison">
                <h2>Comparison</h2>
                <p>(you don't have to understand this)</p>
                <div class="fragment">
                  <table>
                    <thead>
                      <tr>
                        <th>C++</th>
                        <th>Binary</th>
                        <th>Text</th>
                      </tr>
                    </thead>
                    <tbody>
                      <tr>
                        <td class="fragment">
                          <pre class="reformat">int factorial(int n) {
                            &#9;if (n == 0) {
                            &#9;&#9;return 1;
                            &#9;} else {
                            &#9;&#9;return n * factorial(n-1);
                            &#9;}
                          }</pre>
                        </td>
                        <td class="fragment">
                          <pre class="reformat">20 00
                          42 00
                          51
                          04 7e
                          42 01
                          05
                          20 00
                          20 00
                          42 01
                          7d
                          10 00
                          7e
                          0b</pre>
                        </td>
                      <td class="fragment">
                        <pre class="reformat">get_local 0
                          i64.const 0
                          i64.eq
                          if i64
                          i64.const 1
                          else
                          get_local 0
                          get_local 0
                          i64.const 1
                          i64.sub
                          call 0
                          i64.mul
                          end
                        </pre>
                      </td>
                    </tr>
                    </tbody>
                  </table>
                  <a href="https://developer.mozilla.org/en-US/docs/WebAssembly/Understanding_the_text_format">understanding wasm text format</a>
                </div>
              </section>
              <section id="format-overview">
                <h2>Minimum viable product</h2>
                <ul>
                  <li class="fragment">wasm format</li>
                  <li class="fragment">modules</li>
                  <li class="fragment">stack machine</li>
                  <li class="fragment">no DOM & no APIs</li>
                </ul>
              </section>
              <section id="js-symbiosis">
                <img src="images/wasm-logo.png" alt="The WebAssembly logo" class="plain a1-wasm">
                <img src="images/js-logo.png" alt="complements the (unofficial) JS logo" class="fragment plain a1-js">
                <img src="images/overlay-js-features.svg" alt="the metaphor being that JS has all the existing features" class="fragment plain overlay">
                <img src="images/overlay-wasm-features.svg" alt="whereas wasm has the raw power" class="fragment plain overlay">
                <p class="a1-attribution">logo by @carlosbaraza</p>
              </section>
            </section>
            <section id="concepts-and-walkthrough">
              <section id="js-code-demo">
                <h2>WebAssembly concepts in code</h2>
                <pre class="reformat" style="font-size:28px;"><code><span class="fragment">fetch('program.wasm')</span>
                  &#9;<span class="fragment">.then( response   => response.arrayBuffer() )</span>
                  &#9;<span class="fragment">.then( buffer     => <a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/WebAssembly/compile">WebAssembly.compile</a>(buffer) )</span>
                  &#9;<span class="fragment">.then( wasmModule => </span><span class="fragment"><a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/WebAssembly/instantiate">WebAssembly.instantiate</a>(wasmModule</span><span class="fragment">, {
                  &#9;&#9;env: { printf: someFunction }
                  &#9;}))</span>
                  &#9;<span class="fragment">.then( results    => results.exports.main() );</span></code></pre>
                <p class="fragment"><strong>Eventually</strong>: <code>&lt;script type='module'&gt;</code> or ES6 imports</p>
              </section>
              <section id="data-types">
                <h2>Data types</h2>
                <table class="fragment">
                <thead>
                <tr><th>Type</th><th>32 bit</th><th>64 bit</th></tr>
                </thead>
                <tbody>
                <tr><td>Integer</td><td>✔</td><td>✔</td></tr>
                <tr><td>Float</td><td>✔</td><td>✔</td></tr>
                </tbody>
                </table>
                <img src="images/kitty-string.svg" alt="" class="plain">
                <img src="images/kitty-no-string.svg" alt="strings aren't supported" class="plain fragment">
              </section>
              <section id="memory">
                <h2>WebAssembly Memory</h2>
                <ul>
                  <li class="fragment">an ArrayBuffer</li>
                  <li class="fragment">import &amp; export</li>
                  <li class="fragment">this is how we share data</li>
                </ul>
              </section>
              <!-- <section id="synchronous-multiprocess">
                <h2>What about race conditions?</h2>
                <ul>
                  <li class="fragment">wasm &amp; JS run in the same process</li>
                  <li class="fragment">use web workers</li>
                </ul>
              </section> -->
              <section id="what-is-it-good-for">
                <h2 style="margin-top:150px">So what can we do with it?</h2>
                <ul>
                  <li class="fragment">binary data <img src="images/overlay-usecases-binary.svg" alt="" class="plain overlay"></li>
                  <li class="fragment">
                    audio, video, gaming
                    <img src="images/overlay-usecases-audio.svg" alt="" class="plain overlay fragment">
                    <img src="images/overlay-usecases-video.svg" alt="" class="plain overlay fragment">
                    <img src="images/overlay-usecases-gaming.svg" alt="" class="plain overlay fragment">
                  </li>
                  <li class="fragment">everything else</li>
                </ul>

                <img src="images/overlay-usecases-helloworld.svg" alt="" class="plain overlay fragment">
              </section>
            </section>
            <section id="wasm-explorer-demo">
              <section data-transition="none">
                <video class="stretch" src="videos/wasm-explorer-1.webm">
              </section>
              <section data-transition="none">
                <video class="stretch" data-autoplay src="videos/wasm-explorer-1.webm">
              </section>
              <section data-transition="none">
                <video class="stretch" data-autoplay src="videos/wasm-explorer-2.webm">
              </section>
              <section data-transition="none">
                <video class="stretch" data-autoplay src="videos/wasm-explorer-3.webm">
              </section>
            </section>
            <section id="running-wasm-demo">
              <section data-transition="none" data-background="black">
                  <video class="stretch" data-autoplay src="videos/coding-example/1.webm"></video>
              </section>
              <section data-transition="none" data-background="black">
                  <video class="stretch" data-autoplay src="videos/coding-example/2.webm"></video>
              </section>
              <section data-transition="none" data-background="black">
                  <video class="stretch" data-autoplay src="videos/coding-example/3.webm"></video>
              </section>
              <section data-transition="none" data-background="black">
                  <video class="stretch" data-autoplay src="videos/coding-example/4.webm"></video>
              </section>
              <section data-transition="none" data-background="black">
                  <video class="stretch" data-autoplay src="videos/coding-example/5.webm"></video>
              </section>
              <section data-transition="none" data-background="black">
                  <video class="stretch" data-autoplay src="videos/coding-example/6.webm"></video>
              </section>
              <section data-transition="none" data-background="black">
                  <video class="stretch" data-autoplay src="videos/coding-example/7.webm"></video>
              </section>
              <section data-transition="none" data-background="black">
                  <video class="stretch" data-autoplay src="videos/coding-example/8.webm"></video>
              </section>
              <section data-transition="none" data-background="black">
                  <video class="stretch" data-autoplay src="videos/coding-example/9.webm"></video>
              </section>
              <section data-transition="none" data-background="black">
                  <video class="stretch" data-autoplay src="videos/coding-example/10.webm"></video>
              </section>
              <section data-transition="none" data-background="black">
                  <video class="stretch" data-autoplay src="videos/coding-example/11.webm"></video>
              </section>
              <section data-transition="none" data-background="black">
                  <video class="stretch" data-autoplay src="videos/coding-example/12.webm"></video>
              </section>
              <section data-transition="none" data-background="black">
                  <video class="stretch" data-autoplay src="videos/coding-example/13.webm"></video>
              </section>
              <section data-transition="none" data-background="black">
                  <video class="stretch" data-autoplay src="videos/coding-example/14.webm"></video>
              </section>
              <section data-transition="none" data-background="black">
                  <video class="stretch" data-autoplay src="videos/coding-example/15.webm"></video>
              </section>
              <section data-transition="none" data-background="black">
                  <video class="stretch" data-autoplay src="videos/coding-example/16.webm"></video>
              </section>
              <section data-transition="none" data-background="black">
                  <video class="stretch" data-autoplay src="videos/coding-example/17.webm"></video>
              </section>
              <section id="js-code-demo-annotated" data-background="black">
                <h2 style="margin-top:171px">The final product</h2>
                <pre class="reformat" style="font-size:28px;"><code>fetch('program.wasm')
                  &#9;.then( response   => response.arrayBuffer() )
                  &#9;.then( buffer     => <a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/WebAssembly/compile">WebAssembly.compile</a>(buffer) )
                  &#9;.then( wasmModule => <a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/WebAssembly/instantiate">WebAssembly.instantiate</a>(wasmModule, {
                  &#9;&#9;env: { printf: someFunction }
                  &#9;}))
                  &#9;.then( results    => results.exports.main() );</code></pre>
                  <img alt="" src="images/overlay-textdecoder.svg" class="plain fragment overlay">
              </section>
              <section id="summary">
                <div class="row">
                  <div class="col">
                    <h2 style="margin-top:200px;">Raw wasm power!</h2>
                    <ul>
                      <li class="fragment">data types</li>
                      <li class="fragment">imports &amp; exports</li>
                      <li class="fragment">isolated memory</li>
                    </ul>
                    <p class="fragment">innovation in wheel technology</p>
                  </div>
                  <div class="col">
                    <img src="images/pinwheel.svg" class="plain">
                  </div>
              </section>
            </section>
            <section id="emscripten-intro">
              <section id="emscripten-logo">
                <h2>
                  <a href="https://github.com/kripken/emscripten">
                    <img alt="emscripten" src="images/emscripten-logo.svg" class="plain">
                  </a>
                  <!-- todo: scribbles compile to js, asm.js, wasm output, -->
                </h2>
                <p  class="fragment">compiles C and C++ into JavaScript</p>
                <p class="fragment">port <a href="https://github.com/kripken/emscripten/wiki/Porting-Examples-and-Demos">everything</a> to the browser!</p>
                <img alt="" src="images/overlay-asmjs.svg" class="plain fragment overlay">
                <img alt="" src="images/overlay-compile-to-wasm.svg" class="plain fragment overlay">
              </section>
              <section id="random-cool-stuff" data-background="images/demos-blurred.jpg">
                <h2>Random cool stuff</h2>
                <ul>
                  <li>Unity, Unreal &amp; other game engines</li>
                  <li>languages: lua, python, ruby, .NET runtime</li>
                  <li>sqlite, ffmpeg, qemu</li>
                </ul>
                <p class="fragment">and so much more&hellip;</p>
              </section>
              <section id="internet-archive" data-background="images/demos-blurred.jpg">
                <div class="row">
                  <div>
                    <h3 style="margin-top:180px;">Recently</h3>
                    <ul>
                      <li>Internet Archive</li>
                      <li>play old games!</li>
                      <li><a href="https://github.com/jsmess/jsmess">MAME</a> &amp; <a href="https://github.com/dreamlayers/em-dosbox">DOSBox</a></li>
                      <li>all emscripten</li>
                    </ul>
                  </div>
                  <div>
                    <img src="images/internet-archive-tall.png">
                  </div>
                </div>
              </section>
              <section id="all-the-games" data-background="images/demos.jpg">
                <h2 style="background:black;padding:0.2em;color:white;">All the games</h2>
              </section>
              <section id="pesky-details" data-background="images/demos.jpg">
                <h2 style="background:black;padding:0.2em;color:white;">Smooths away those pesky details</h2>
              </section>
            </section>
            <section id="emscripten-demo">
              <section id="c-compile-demo"  class="terminal" data-samElement="#c-compile-demo-terminal" data-samFile="c-compile.pias">
                  <div id="c-compile-demo-terminal" class="emulator">sam</div>
              </section>
              <section id="why-so-large">
                <h2>So why is this so big?</h2>
                <p class="fragment">complete solution</p>
                <!-- kinda like jQuery -->
              </section>
            </section>
            <section id="where-from-here">
              <section id="what-can-we-do">
                <h2>So what can we do today?</h2>
                <ul>
                  <li class="fragment">hack stuff</li>
                  <li class="fragment">build games</li>
                  <li class="fragment">migrate existing asm.js</li>
                </ul>
                <p class="fragment">The future is near…</p>
              </section>
              <section>
                <h2>The future looks like this:</h2>
                <ul>
                  <li class="fragment">spec will evolve</li>
                  <li class="fragment">the tools will improve</li>
                  <li class="fragment">many languages for the web</li>
                </ul>
              </section>
              <section id="more-resources">
                <div class="row">
                  <div class="col">
                    <h2><img src="images/webassembly-logo.svg" alt="WebAssembly" class="plain"></h2>
                    <p style="font-size:0.6em;">@ashkyd | ash.ms</p>
                    <p><small><script>document.write(window.location)</script></small></p>
                  </div>
                  <div class="col left">
                    <h2>Some resources</h2>
                    <div class="fragment">
                      <div class="headingthing">intro</div>
                      <ul><li><div><a href="https://hacks.mozilla.org/2017/02/a-cartoon-intro-to-webassembly/">cartoon wasm</a> - Lin Clark</div></li></ul>
                    </div>
                    <div class="fragment">
                      <div class="headingthing">usage</div>
                      <ul>
                        <li><div><a href="https://kripken.github.io/emscripten-site/docs/porting/connecting_cpp_and_javascript/Interacting-with-code.html">emscripten interacting with code</a></div></li>
                        <li><div><a href="https://medium.com/@ianjsikes/get-started-with-rust-webassembly-and-webpack-58d28e219635">rust webpack</a> - Ian Sikes</div></li>
                      </ul>
                    </div>
                    <div class="fragment">
                      <div class="headingthing">more info</div>
                      <ul><li><div><a href="https://developer.mozilla.org/en-US/docs/WebAssembly">wasm mdn</a> - lots o' docs</div></li></ul>
                    </div>
                  </div>
                </div>
              </section>
            </section>
          </div>
        </div>
    </body>
</html>
